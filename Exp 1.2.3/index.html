<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experiment: SVG Drawing Tool</title>
    <style>
        /* 1. RESET & BASIC LAYOUT */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f3f4f6; /* Light grey background */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: #1f2937;
        }

        /* 2. MAIN CARD CONTAINER */
        .card {
            background-color: white;
            padding: 2rem;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05); /* Soft shadow */
            width: 90vw;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* 3. CONTROLS HEADER (Color & Undo) */
        .controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* Custom Color Picker Styling */
        .color-wrapper {
            position: relative;
            width: 50px;
            height: 50px;
            overflow: hidden;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
            cursor: pointer;
            background-color: #3b82f6; /* Default blue */
            transition: transform 0.2s;
        }

        .color-wrapper:hover {
            transform: scale(1.05);
        }

        /* Hide the actual ugly input but keep it functional */
        input[type="color"] {
            position: absolute;
            top: -10px;
            left: -10px;
            width: 200%;
            height: 200%;
            cursor: pointer;
            opacity: 0; /* Invisible but clickable */
        }

        /* Undo Button Styling */
        .btn-undo {
            background-color: #3b82f6; /* Blue */
            color: white;
            border: none;
            padding: 0 1.5rem;
            height: 50px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            flex-grow: 1; /* Button takes remaining width if needed */
            max-width: 120px;
        }

        .btn-undo:hover {
            background-color: #2563eb; /* Darker blue */
        }

        .btn-undo:active {
            transform: translateY(1px);
        }

        /* 4. SVG CANVAS AREA */
        .canvas-container {
            width: 100%;
            height: 400px; /* Fixed height for drawing area */
            border: 2px dashed #d1d5db; /* Dashed border like image */
            border-radius: 1rem;
            position: relative;
            overflow: hidden;
            background-color: #fff;
        }

        svg {
            width: 100%;
            height: 100%;
            cursor: crosshair; /* Crosshair cursor for drawing precision */
            display: block;
        }

        /* Style for the drawn circles */
        circle {
            transition: r 0.3s ease-out; /* Pop-in animation */
        }

        /* 5. FOOTER (Counter) */
        .footer {
            text-align: center;
            font-size: 1.2rem;
            font-weight: 500;
            color: #374151;
        }

    </style>
</head>
<body>

    <div class="card">
        <div class="controls">
            <div class="color-wrapper" id="colorDisplay">
                <input type="color" id="colorInput" value="#3b82f6">
            </div>
            <button id="undoBtn" class="btn-undo">Undo</button>
        </div>

        <div class="canvas-container">
            <svg id="drawingArea"></svg>
        </div>

        <div class="footer">
            Circles drawn: <span id="count">0</span>
        </div>
    </div>

    <script>
        // --- 1. SELECTION ---
        const svg = document.getElementById('drawingArea');
        const colorInput = document.getElementById('colorInput');
        const colorDisplay = document.getElementById('colorDisplay');
        const undoBtn = document.getElementById('undoBtn');
        const countSpan = document.getElementById('count');

        // State variables
        let circleCount = 0;
        let elementsStack = []; // Stack to keep track of drawn elements for Undo

        // --- 2. HELPER FUNCTIONS ---

        // Update the visual color box when input changes
        function updateColorDisplay(color) {
            colorDisplay.style.backgroundColor = color;
        }

        // Function to create a circle
        function createCircle(x, y, color) {
            const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
            
            // Set attributes
            circle.setAttribute("cx", x);
            circle.setAttribute("cy", y);
            circle.setAttribute("r", "0"); // Start at radius 0 for animation
            circle.setAttribute("fill", color);
            
            // Append to SVG
            svg.appendChild(circle);
            
            // Animate radius to 15px (pop effect)
            setTimeout(() => {
                circle.setAttribute("r", "15");
            }, 10);

            return circle;
        }

        // --- 3. EVENT LISTENERS ---

        // A. Draw on Click
        svg.addEventListener('mousedown', (event) => {
            // Get mouse position relative to the SVG element
            const rect = svg.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            const color = colorInput.value;

            // Draw
            const newCircle = createCircle(x, y, color);

            // Update State
            elementsStack.push(newCircle);
            circleCount++;
            countSpan.textContent = circleCount;
        });

        // B. Update Color Picker UI
        colorInput.addEventListener('input', (e) => {
            updateColorDisplay(e.target.value);
        });

        // C. Undo Functionality
        undoBtn.addEventListener('click', () => {
            if (elementsStack.length > 0) {
                // Get the last circle drawn
                const lastCircle = elementsStack.pop();
                
                // Remove it from the DOM
                svg.removeChild(lastCircle);

                // Update counter
                circleCount--;
                countSpan.textContent = circleCount;
            }
        });

    </script>
</body>
</html>
